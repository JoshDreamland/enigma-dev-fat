# Call this file from the directory in question if you would like a generic
# makefile generated which invokes GCC for each individual file.

echo "#Awesome makefile generated by ENIGMAsystem/Developer/automake.sh" > makefile
echo "" >> makefile;

for file in *.cpp ;
  do
  {
    printf ".eobjs_\$(MODE)/${file%.cpp}.o:" >> makefile;
    for i in `c_incl $file | gawk '/\/usr\/include/ { next } { print } '`;
    do
      printf " $i" >> makefile;
    done;
    echo "" >> makefile;
    
    echo "	-mkdir .eobjs_\$(MODE)" >> makefile;
    echo "	g++ -c $file		-o .eobjs_\$(MODE)/${file%.cpp}.o \$(FLAGS)"  >> makefile;
  };
  done;

echo "" >> makefile;

#generate targets for each ENIGMA mode.
for modename in Run Debug Build Release;
do
  printf "$modename: " >> makefile;
  for file in *.cpp ;
    do printf ".eobjs_$modename/${file%.cpp}.o " >> makefile; 
    done;
  echo "" >> makefile;
  
  echo "	-mkdir .eobjs_$modename/" >> makefile;
done;

echo "" >> makefile;
echo "clean:" >> makefile;
echo "	rm -f .eobjs/*" >> makefile;

